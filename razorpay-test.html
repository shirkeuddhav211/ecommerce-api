<!DOCTYPE html>
<html>

<head>
    <title>Razorpay Payment Test</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>

<body>

    <button onclick="pay()">Pay Now</button>

    <script>
        async function pay() {
            // 1️⃣ Create Razorpay Order from backend
            const res = await fetch('http://localhost:5000/payment/create/1', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjcsInJvbGUiOiJVU0VSIiwiaWF0IjoxNzY3NTQwOTQxLCJleHAiOjE3Njc2MjczNDF9.ToEgEpcRq0bXnLIoHuf7Lx-4seqwBkxePaLA27um3QY'
                }
            });

            const data = await res.json();

            // 2️⃣ Open Razorpay Checkout
            const options = {
                key: data.keyId,
                amount: data.amount,
                currency: data.currency,
                name: "My Ecommerce Store",
                description: "Order Payment",
                order_id: data.razorpayOrderId,
                handler: async function (response) {
                    // 3️⃣ Verify payment with backend
                    await fetch('http://localhost:5000/payment/verify', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjcsInJvbGUiOiJVU0VSIiwiaWF0IjoxNzY3NTQwOTQxLCJleHAiOjE3Njc2MjczNDF9.ToEgEpcRq0bXnLIoHuf7Lx-4seqwBkxePaLA27um3QY'
                        },
                        body: JSON.stringify({
                            razorpay_order_id: response.razorpay_order_id,
                            razorpay_payment_id: response.razorpay_payment_id,
                            razorpay_signature: response.razorpay_signature,
                            orderId: 1
                        })
                    });

                    alert('Payment Successful!');
                }
            };

            const rzp = new Razorpay(options);
            rzp.open();
        }
    </script>

</body>

</html>